!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=307)}({307:function(e,t,n){"use strict";function r(e,t,n,r,o,s,a){try{var c=e[s](a),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,s){var a=e.apply(t,n);function c(e){r(a,o,s,c,i,"next",e)}function i(e){r(a,o,s,c,i,"throw",e)}c(void 0)})}}n.r(t),n.d(t,"insert",function(){return w});var s={welcome:"Find paragraphs in the writings of Ellen White.",find:"Find",searchBoxHint:"Find...",searchInProgress:"Looking up phrase...",noResult:"No matches found",insert:"Insert",errorTryLater:"Error during search. <br>Try again later!"},a={welcome:"Keress az Ellen Gould White Könyvtár bekezdéseiben!",find:"Keresés",searchBoxHint:"Keresés...",searchInProgress:"Keresés...",noResult:"A megadott kifejezésre nincsen találat",insert:"Beszúrás",errorTryLater:"Hiba a keresés során. <br>Próbáld újra később!"},c=s,i=!1,u="";function l(){return d.apply(this,arguments)}function d(){return(d=o(regeneratorRuntime.mark(function e(){var t,n,r,s,a,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=function(){return(a=o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.forEach(function(){var e=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t.para_id);case 2:t.refcode_short=e.sent;case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return");case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},s=function(){return a.apply(this,arguments)},t=document.getElementById("searchBox").value,i!==t){e.next=5;break}return e.abrupt("return",!1);case 5:for(i=t,document.querySelector("#welcome-text").style.display="none",n=document.getElementById("search-results");n.firstChild;)n.removeChild(n.firstChild);return h(),[],e.next=14,m(t);case 14:return r=e.sent,e.next=17,s();case 17:return e.next=19,m(t,!1);case 19:return c=e.sent,u=[],e.next=23,f(c,function(){var e=o(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.refcode_short.toLowerCase()!=t.toLowerCase()){e.next=5;break}return e.next=3,g(t);case 3:(u=e.sent).forEach(function(e){e.refcode_short=n.refcode_short});case 5:case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 23:x(r.concat(u,c)),h(!1);case 26:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(e,t){return p.apply(this,arguments)}function p(){return(p=o(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<t.length)){e.next=7;break}return e.next=4,n(t[r],r,t);case 4:r++,e.next=1;break;case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];document.querySelector("#search-spinner").style.display=e?"block":"none"}function m(e){return v.apply(this,arguments)}function v(){return(v=o(regeneratorRuntime.mark(function e(t){var n,r,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(o.length>1&&void 0!==o[1])||o[1],r=new XMLHttpRequest,e.abrupt("return",new Promise(function(e,o){r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300?(u=JSON.parse(r.responseText).data,e(u)):(b(c.errorTryLater),console.log("Hiba történt az xhr során. (search)")))},r.onerror=function(){console.log(r.statusText)};var s="https://api.white-konyvtar.hu/reader/search"+(n?"/translation":"")+"?query="+encodeURIComponent(t);r.open("GET",s),r.send()}));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(e){var t=new XMLHttpRequest;return new Promise(function(n,r){t.onreadystatechange=function(){if(4===t.readyState)if(t.status>=200&&t.status<300){var e=JSON.parse(t.responseText).data[0].refcode_short;n(e)}else console.log("Hiba történt az xhr során. (getRefCode)",t.status,t.statusText)},t.onerror=function(){console.log(t.statusText)};var o="https://api.white-konyvtar.hu/reader/paragraph/"+encodeURIComponent(e);t.open("GET",o),t.send()})}function g(e){var t=new XMLHttpRequest;return new Promise(function(n,r){t.onreadystatechange=function(){if(4===t.readyState)if(t.status>=200&&t.status<300){var e=JSON.parse(t.responseText).data[0].translations;n(e)}else console.log("Hiba történt az xhr során. (findByRefcode)")},t.onerror=function(){console.log(t.statusText)};var o="https://api.white-konyvtar.hu/reader/paragraph/"+encodeURIComponent(e);t.open("GET",o),t.send()})}function x(e){var t=Object.keys(e).length;if(t>0){for(var n="",r=0;r<t;r++){n+=o='\n      <li class="ms-ListItem result-li">\n        <div class="result-text">\n          <p>'.concat(e[r].content,'</p>\n          <div class="fade-effect"></div>\n        </div>\n        <button class="unhideText">\n          <div class="arrowhead down"></div>\n        </button>\n        <div class="resultButtons">\n          <button class="insertText ms-Button">').concat(c.insert,'</button>\n          <div class="result-reference">{').concat(e[r].refcode_short,'}</div>\n        </div>\n        <hr style="border: 0; border-top: 1px solid #eaeaea">\n      </li>\n      ')}document.getElementById("search-results").innerHTML=n}else{console.log("nincs találat");var o='\n      <div class="no-result center">'.concat(c.noResult,"</div>\n    ");document.getElementById("search-results").innerHTML+=o}Array.prototype.forEach.call(document.getElementsByClassName("result-li"),function(t,n,r){t.getElementsByClassName("insertText")[0].onclick=function(t){w(e[n].content,e[n].refcode_short)},t.querySelector(".unhideText").onclick=function(e){var n=t.querySelector(".result-text");if(this.classList.contains("opened"))this.classList.remove("opened"),n.classList.remove("opened"),n.style.maxHeight="10rem";else{this.classList.add("opened"),n.classList.add("opened");var r=n.querySelector("p").offsetHeight;n.style.maxHeight=r+"px"}}});var s=document.querySelectorAll(".result-text");Array.prototype.forEach.call(s,function(e){var t=e.querySelector("p"),n=e.clientHeight;t.offsetHeight>n&&e.classList.add("tooLong")})}function b(e){h(!1);var t='<div class="no-result center">'.concat(e,"</div>");document.getElementById("search-results").innerHTML=t}function w(e,t){return A.apply(this,arguments)}function A(){return(A=o(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u=t+" {"+n+"}",Office.context.document.setSelectedDataAsync(u,{coercionType:Office.CoercionType.Text},function(e){e.status===Office.AsyncResultStatus.Failed&&console.error(e.error.message)});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}Office.onReady(function(e){if(e.host===Office.HostType.PowerPoint){switch(Office.context.displayLanguage){case"hu-HU":c=a;break;default:c=s}var t,n='\n    <div class="top-search">\n      <div class="searchbox-container">\n        <form onsubmit="return false">\n          <div class="BorderGray">\n            <input class="DefaultText" type="text" id="searchBox" placeholder="'.concat(c.searchBoxHint,'">\n            <input title="').concat(c.find,'" id="submitSearch" class="BtnSearchButton" type="image" alt="').concat(c.find,'" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAbFBMVEW9vb3AwMDb29vo6OjIyMjk5OTKysrBwcHu7u709PTOzs7R0dHS0tLV1dXZ2dnDw8Pd3d3e3t7g4ODh4eG/v7++vr7p6enq6urs7Ozt7e3MzMzw8PDx8fHNzc3+/v7////GxsbQ0NDPz8/i4uIwwMXbAAAAaUlEQVR4Xp2QRw6EQAwEx/YEcs6Z3f//kXAxMCfoS0klS25bzFbeKSeQK90UQkQo/YtqwdkxjRkrH0+QZKXVCTe2pirJqimHA17K6i+KvFG/jjciQNAtOuFeYQHq3t41pn4eRP2nT1jZABlDIuI2GxSeAAAAAElFTkSuQmCC">\n          </div>\n        </form>\n      </div>\n    </div>\n    <main id="app-body" class="ms-welcome__main">\n      <div id="welcome-text" class="center">\n        <p>\n          ').concat(c.welcome,'\n        </p>\n        <p>\n          <a href="http://egw.hu">http://egw.hu</a>\n        </p>\n      </div>\n      <div id="search-spinner" style="display: none;">\n        <div>\n          ').concat(c.searchInProgress,'\n          <div class="spinner"></div>\n        </div>\n      </div>\n      <ul class="ms-List"  id="search-results">\n      </ul>\n    </main>\n    ');document.getElementById("app-container").innerHTML=n,document.getElementById("searchBox").addEventListener("keyup",function(e){clearTimeout(t),t=setTimeout(function(){l()},1e3)}),document.getElementById("submitSearch").onclick=function(){i=!1,l()}}})}});
//# sourceMappingURL=taskpane.js.map